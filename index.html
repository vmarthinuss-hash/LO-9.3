<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ReadingQuest - Academic Reading Game</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap');
        body {
            margin: 0;
            font-family: 'Inter', sans-serif;
        }
        .vertical-rl {
            writing-mode: vertical-rl;
        }
        @keyframes fade-in {
            from { opacity: 0; }
            to { opacity: 1; }
        }
        @keyframes slide-in-from-right-8 {
            from { transform: translateX(2rem); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
        @keyframes zoom-in-95 {
            from { transform: scale(0.95); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes zoom-in-90 {
            from { transform: scale(0.90); opacity: 0; }
            to { transform: scale(1); opacity: 1; }
        }
        @keyframes slide-in-from-bottom-4 {
            from { transform: translateY(1rem); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        .animate-in {
            animation-fill-mode: both;
        }
        .fade-in {
            animation: fade-in 0.5s ease-out;
        }
        .slide-in-from-right-8 {
            animation: slide-in-from-right-8 0.5s ease-out;
        }
        .zoom-in-95 {
            animation: zoom-in-95 0.3s ease-out;
        }
        .zoom-in-90 {
            animation: zoom-in-90 0.5s ease-out;
        }
        .slide-in-from-bottom-4 {
            animation: slide-in-from-bottom-4 0.3s ease-out;
        }
        .duration-300 { animation-duration: 0.3s; }
        .duration-500 { animation-duration: 0.5s; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;
        const { 
          BookOpen, Target, Map, Award, ChevronRight, ChevronLeft, CheckCircle2, AlertCircle,
          Lightbulb, ShieldCheck, Zap, Leaf, Droplets, Cpu, Info, Glasses, Search, Wind,
          Layers, Flag, ListChecks, User, GraduationCap, Star, Sparkles
        } = lucide;

        const App = () => {
          // Game State
          const [currentPage, setCurrentPage] = useState('landing');
          const [activeModule, setActiveModule] = useState(null);
          const [showHandbook, setShowHandbook] = useState(false);
          const [showCertForm, setShowCertForm] = useState(false);
          const [showFinalCert, setShowFinalCert] = useState(false);
          
          const [studentInfo, setStudentInfo] = useState({
            name: '',
            className: ''
          });

          const [userStats, setUserStats] = useState({
            points: 0,
            completedModules: [],
            streak: 1
          });
          
          const [currentStep, setCurrentStep] = useState(0);
          const [feedback, setFeedback] = useState(null);

          // Content Data
          const modules = [
            {
              id: 'conservation',
              title: 'Earth Guardians',
              subtitle: 'Why Every Action Matters',
              icon: React.createElement(ShieldCheck, { className: "w-8 h-8 text-indigo-600" }),
              difficulty: 'Expert',
              color: 'indigo',
              lo: 'LO 9.3.a',
              text: [
                { id: 'p1', title: 'P1: Introduction', content: "The environment includes everything around us, such as air, water, land, plants, and animals. It provides humans with food, clean water, and resources needed for daily life. However, human activities have caused serious damage to the environment. Understanding environmental problems is the first step toward protecting our planet for future generations." },
                { id: 'p2', title: 'P2: Pollution and Its Effects', content: "One major environmental problem is pollution. Pollution happens when harmful substances enter the air, water, or soil. For example, factories release smoke into the air, and plastic waste is often thrown into rivers and oceans. As a result, pollution harms wildlife, damages ecosystems, and can cause health problems for humans." },
                { id: 'p3', title: 'P3: Climate Change', content: "Another serious issue is climate change. Climate change refers to long-term changes in temperature and weather patterns. These changes are mainly caused by human activities such as burning fossil fuels and cutting down forests. Climate change leads to extreme weather, rising sea levels, and the loss of natural habitats." },
                { id: 'p4', title: 'P4: The Importance of Conservation', content: "Conservation means protecting natural resources and using them wisely. By conserving water, reducing waste, and recycling materials, people can help reduce environmental damage. Governments and organizations also play an important role by creating laws that protect the environment and promote sustainable practices." },
                { id: 'p5', title: 'P5: What Individuals Can Do', content: "Although environmental problems are global, individuals can still make a difference. Simple actions such as saving electricity, using reusable bags, and planting trees can have a positive impact. When people work together, small actions can lead to big changes and help protect the environment for the future." }
              ],
              questions: [
                { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 1?", options: ["The environment is already destroyed", "The environment is important and needs protection", "Humans cannot survive without technology", "Animals are more important than humans"], correct: 1 },
                { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 2?", options: ["Factories help the economy", "Plastic is useful in daily life", "Pollution causes harm to the environment and humans", "Rivers are important natural resources"], correct: 2 },
                { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 3?", options: ["Weather changes every day", "Climate change is caused by natural disasters", "Climate change is a serious problem caused by human activity", "Forests are important for animals"], correct: 2 },
                { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 4?", options: ["Conservation helps protect natural resources", "Governments should control people", "Recycling is difficult", "Natural resources will never run out"], correct: 0 },
                { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 5?", options: ["Environmental problems are impossible to solve", "Only governments can protect the environment", "Individuals can help protect the environment through simple actions", "Trees are the most important solution"], correct: 2 },
                { type: 'Purpose', objective: 'Sentence Purpose', q: "What is the purpose of the first sentence in Paragraph 1?", options: ["To give an example", "To define the environment", "To explain a solution", "To describe a problem"], correct: 1 },
                { type: 'Detail', objective: 'Connection between Points & Details', q: "Why does the writer mention factories and plastic waste in Paragraph 2?", options: ["To suggest solutions", "To compare two ideas", "To give examples of pollution", "To explain history"], correct: 2 },
                { type: 'Evidence', objective: 'Identify Main Ideas', q: "Which sentence in Paragraph 3 explains the cause of climate change?", options: ["Sentence 1", "Sentence 2", "Sentence 3", "Sentence 4"], correct: 1 },
                { type: 'Analysis', objective: 'Connection between Points & Details', q: "How do the details in Paragraph 4 support the main idea?", options: ["They explain why conservation is impossible", "They give examples of conservation actions", "They describe environmental disasters", "They compare past and present"], correct: 1 },
                { type: 'Synthesis', objective: 'Summarize Main Ideas', q: "What is the connection between the main idea and details in Paragraph 5?", options: ["The details explain why individuals should not act", "The details give examples that support the main idea", "The details repeat the introduction", "The details introduce a new topic"], correct: 1 },
                { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word "resources" in Paragraph 1 most nearly means:", options: ["Rules", "Natural materials people use", "Pollution", "Weather conditions"], correct: 1 },
                { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word "harmful" in Paragraph 2 means:", options: ["Helpful", "Dangerous", "Expensive", "Natural"], correct: 1 },
                { type: 'Vocab', objective: 'Vocabulary in Context', q: "The phrase "refers to" in Paragraph 3 is closest in meaning to:", options: ["Is different from", "Is caused by", "Means", "Depends on"], correct: 2 },
                { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word "sustainable" in Paragraph 4 most nearly means:", options: ["Cheap and easy", "Harmful to nature", "Able to continue without damage", "Temporary"], correct: 2 },
                { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word "impact" in Paragraph 5 means:", options: ["Opinion", "Result or effect", "Rule", "Problem"], correct: 1 }
              ]
            },
            {
              id: 'marine',
              title: 'Marine Depths',
              subtitle: 'The Plastic Pollution Crisis',
              icon: React.createElement(Droplets, { className: "w-8 h-8 text-blue-500" }),
              difficulty: 'Intermediate',
              color: 'blue',
              lo: 'LO 9.3.a',
              text: [
                { id: 'p1', content: "Plastic pollution has emerged as one of the most pressing environmental threats confronting marine ecosystems in the contemporary world. Each year, vast volumes of plastic waste are discharged into the oceans, where they undermine biodiversity and destabilise fragile marine habitats. Owing to the extreme durability and slow degradation of plastic materials, their persistent accumulation generates long-term ecological consequences that disrupt natural food webs and compromise the overall balance of marine environments." },
                { id: 'p2', content: "A particularly serious consequence of plastic pollution is its impact on marine fauna. Numerous species inadvertently ingest plastic debris, mistaking it for food, which can result in internal injury, malnutrition, or fatal blockages. Moreover, as larger plastic items fragment into microplastics, toxic chemicals are able to enter marine food chains, increasing the risk of bioaccumulation and posing significant threats not only to wildlife but also to human health through the consumption of contaminated seafood." },
                { id: 'p3', content: "Although the scale of plastic pollution is alarming, a range of viable solutions has been identified. Measures such as limiting the production of single-use plastics, strengthening waste management infrastructure, and promoting environmental education can substantially reduce the volume of plastic entering marine ecosystems. Ultimately, meaningful progress depends on coordinated and sustained action by governments, industries, and individuals, ensuring that responsibility for environmental protection is shared and that marine ecosystems are preserved for future generations." }
              ],
              questions: [
                { type: 'gist', objective: 'Identify Main Ideas', q: "What is the overall topic of the text?", options: ["Tourism", "Ocean Currents", "The Impact of Plastic Pollution", "Fish Migration"], correct: 2 },
                { type: 'purpose', objective: 'Sentence Purpose', q: "Which option best describes the writer's purpose?", options: ["To describe marine animals", "To explain causes and effects of plastic pollution", "To argue against protection", "To promote seafood"], correct: 1 },
                { type: 'match', objective: 'Sentence Purpose', q: "Match sentence purpose: 'Many species mistakenly consume plastic debris...'", options: ["Introducing the issue", "Explaining consequences", "Providing evidence", "Suggesting solutions"], correct: 1 }
              ]
            },
            {
              id: 'urban',
              title: 'Urban Jungles',
              subtitle: 'The Rise of Urban Gardening',
              icon: React.createElement(Leaf, { className: "w-8 h-8 text-green-500" }),
              difficulty: 'Beginner',
              color: 'green',
              lo: '9.3.a Extension',
              text: [
                { id: 'p1', content: "In recent years, urban gardening has become increasingly popular in large cities around the world. As space becomes more limited, many people are turning rooftops, balconies, and small community areas into green spaces. These gardens not only provide fresh vegetables and herbs but also help improve air quality and reduce stress." },
                { id: 'p2', content: "One major reason for the growth of urban gardening is concern about food safety. Many city residents prefer to grow their own produce to avoid chemicals used in commercial farming. In addition, gardening is seen as a relaxing hobby that allows people to connect with nature despite living in busy urban environments." },
                { id: 'p3', content: "Governments and schools have also begun supporting urban gardening projects. Some cities offer free seeds and training programs, while schools use gardens to teach students about sustainability and healthy eating. As a result, urban gardening is no longer just a trend but a practical solution for greener and healthier cities." }
              ],
              questions: [
                { type: 'skimming', objective: 'Identify Main Ideas', q: "Choose the best title for the passage:", options: ["Life in Big Cities", "Farming in Countryside", "Urban Gardening: A Growing Movement", "The Future of Schools"], correct: 2 },
                { type: 'scanning', objective: 'Connecting Details', q: "Where are urban gardens commonly found?", options: ["Basements", "Rooftops and balconies", "Underwater", "Deep forests"], correct: 1 }
              ]
            }
          ];

          const handleAnswer = (index) => {
            const currentQuestion = activeModule.questions[currentStep];
            if (index === currentQuestion.correct) {
              setFeedback({ type: 'success', msg: 'Correct! +100 XP' });
              setUserStats(prev => ({ ...prev, points: prev.points + 100 }));
              setTimeout(() => {
                if (currentStep < activeModule.questions.length - 1) {
                  setCurrentStep(currentStep + 1);
                  setFeedback(null);
                } else {
                  setFeedback({ type: 'finish', msg: 'Legendary Completion! You mastered the Expert Trail.' });
                  if (!userStats.completedModules.includes(activeModule.id)) {
                    setUserStats(prev => ({ 
                      ...prev, 
                      completedModules: [...prev.completedModules, activeModule.id] 
                    }));
                  }
                }
              }, 1200);
            } else {
              setFeedback({ type: 'error', msg: 'Incorrect. Re-read the paragraph carefully!' });
              setTimeout(() => setFeedback(null), 2000);
            }
          };

          const startModule = (mod) => {
            setActiveModule(mod);
            setCurrentStep(0);
            setCurrentPage('module');
            setFeedback(null);
          };

          const ProgressBar = ({ value, max }) => (
            <div className="w-full bg-slate-200 h-2 rounded-full overflow-hidden">
              <div 
                className="bg-indigo-600 h-full transition-all duration-500" 
                style={{ width: `${(value / max) * 100}%` }}
              />
            </div>
          );

          const CertificateModal = () => (
            <div className="fixed inset-0 bg-slate-900/80 backdrop-blur-md z-[60] flex items-center justify-center p-4">
              {!showFinalCert ? (
                <div className="bg-white rounded-3xl shadow-2xl max-w-md w-full p-8 animate-in zoom-in-95 duration-300">
                  <div className="text-center mb-8">
                    <div className="inline-block p-4 bg-indigo-100 rounded-full mb-4">
                      {React.createElement(Award, { className: "w-12 h-12 text-indigo-600" })}
                    </div>
                    <h2 className="text-2xl font-bold text-slate-800">Claim Your Certificate</h2>
                    <p className="text-slate-500 mt-2">Expert achievements deserve official recognition. Enter your details below.</p>
                  </div>
                  
                  <div className="space-y-4">
                    <div>
                      <label className="block text-xs font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">Full Student Name</label>
                      <div className="relative">
                        {React.createElement(User, { className: "absolute left-3 top-3 w-5 h-5 text-slate-400" })}
                        <input 
                          type="text"
                          value={studentInfo.name}
                          onChange={(e) => setStudentInfo({...studentInfo, name: e.target.value})}
                          className="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"
                          placeholder="Student Name"
                        />
                      </div>
                    </div>
                    <div>
                      <label className="block text-xs font-bold text-slate-400 uppercase mb-1 ml-1 tracking-wider">Class / Grade</label>
                      <div className="relative">
                        {React.createElement(GraduationCap, { className: "absolute left-3 top-3 w-5 h-5 text-slate-400" })}
                        <input 
                          type="text"
                          value={studentInfo.className}
                          onChange={(e) => setStudentInfo({...studentInfo, className: e.target.value})}
                          className="w-full pl-10 pr-4 py-3 bg-slate-50 border border-slate-200 rounded-xl focus:ring-2 focus:ring-indigo-500 outline-none transition-all"
                          placeholder="e.g. 9-Alpha"
                        />
                      </div>
                    </div>
                  </div>

                  <button 
                    disabled={!studentInfo.name || !studentInfo.className}
                    onClick={() => setShowFinalCert(true)}
                    className="w-full mt-8 bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-indigo-100 hover:bg-indigo-700 disabled:opacity-50 transition-all flex items-center justify-center gap-2"
                  >
                    Generate My Certificate
                    {React.createElement(Sparkles, { className: "w-5 h-5" })}
                  </button>
                </div>
              ) : (
                <div className="bg-white rounded-3xl shadow-2xl max-w-4xl w-full p-1 shadow-indigo-500/20 animate-in zoom-in-90 duration-500 overflow-hidden max-h-[90vh] overflow-y-auto">
                  <div className="bg-white p-10 md:p-16 border-8 border-double border-indigo-100 rounded-[2.2rem] relative m-1">
                    <div className="absolute top-0 right-0 p-8 opacity-10">
                      {React.createElement(Award, { className: "w-64 h-64 text-indigo-900" })}
                    </div>
                    <div className="text-center relative z-10">
                      {React.createElement(BookOpen, { className: "w-12 h-12 text-indigo-600 mx-auto mb-6" })}
                      <h1 className="text-5xl font-serif text-slate-800 mb-2">Certificate of Mastery</h1>
                      <p className="text-slate-400 font-bold uppercase tracking-[0.3em] text-sm mb-12 italic">Academic Reading & Environmental Ethics</p>
                      
                      <div className="mb-12">
                        <p className="text-slate-500 italic text-xl mb-4">This distinguished honor is awarded to</p>
                        <h2 className="text-4xl font-bold text-indigo-700 border-b-2 border-slate-200 inline-block px-16 py-2 mb-4 font-serif">
                          {studentInfo.name}
                        </h2>
                        <p className="text-slate-500 text-lg">
                          representing Class <span className="font-bold text-slate-800 tracking-wider">{studentInfo.className}</span>
                        </p>
                      </div>

                      <div className="max-w-xl mx-auto mb-16 bg-white p-6 rounded-2xl border border-slate-100 shadow-sm text-sm">
                        <p className="text-slate-600 leading-relaxed mb-4">
                          Successfully completed the <strong>{activeModule.title}</strong> trail, demonstrating expert proficiency in <strong>{activeModule.lo}</strong>.
                        </p>
                        <div className="flex justify-center gap-2">
                          <span className="bg-green-50 text-green-700 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-tighter">Main Idea Mastery</span>
                          <span className="bg-blue-50 text-blue-700 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-tighter">Analytical Literacy</span>
                          <span className="bg-indigo-50 text-indigo-700 px-3 py-1 rounded-full text-[10px] font-bold uppercase tracking-tighter">Critical Thinking</span>
                        </div>
                      </div>

                      <div className="flex flex-col md:flex-row justify-between items-center gap-8 mt-12 px-12">
                        <div className="text-center">
                          <div className="w-48 border-b border-slate-300 py-2 mb-1">
                            <span className="font-serif italic text-slate-400 text-sm">ReadingQuest Academy</span>
                          </div>
                          <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Master Educator</p>
                        </div>
                        <div className="bg-indigo-600 text-white p-4 rounded-full shadow-lg shadow-indigo-200">
                          {React.createElement(ShieldCheck, { className: "w-10 h-10" })}
                        </div>
                        <div className="text-center">
                          <div className="w-48 border-b border-slate-300 py-2 mb-1">
                            <span className="font-mono text-slate-800 text-sm">{new Date().toLocaleDateString()}</span>
                          </div>
                          <p className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">Date Issued</p>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div className="bg-slate-900 p-4 flex justify-between items-center px-8">
                    <p className="text-slate-500 text-xs">CERT-ID: {Math.random().toString(36).substr(2, 9).toUpperCase()}</p>
                    <button 
                        onClick={() => { setShowFinalCert(false); setShowCertForm(false); setCurrentPage('landing'); }}
                        className="text-white px-8 py-2 rounded-lg font-bold bg-indigo-600 hover:bg-indigo-500 transition-all text-sm"
                      >
                        Return to Trails
                    </button>
                  </div>
                </div>
              )}
            </div>
          );

          const HandbookOverlay = () => (
            <div className="fixed inset-0 bg-slate-900/60 backdrop-blur-sm z-50 flex items-center justify-center p-4">
              <div className="bg-white rounded-3xl shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-y-auto">
                <div className="sticky top-0 bg-white border-b p-6 flex justify-between items-center z-10">
                  <div className="flex items-center gap-3">
                    {React.createElement(BookOpen, { className: "w-6 h-6 text-indigo-600" })}
                    <h2 className="text-2xl font-bold text-slate-800 font-serif">The Reading Strategist's Handbook</h2>
                  </div>
                  <button onClick={() => setShowHandbook(false)} className="p-2 hover:bg-slate-100 rounded-full transition-colors font-bold">âœ•</button>
                </div>
                <div className="p-8 space-y-8">
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div className="bg-blue-50 p-6 rounded-2xl border border-blue-100">
                      <div className="flex items-center gap-3 mb-4 text-blue-700 font-bold">
                        {React.createElement(Wind, { className: "w-5 h-5" })} 1. Skimming
                      </div>
                      <p className="text-sm text-blue-800 leading-relaxed">Reading rapidly to get the general overview. Focus on titles, subheadings, and the first/last sentences of paragraphs.</p>
                    </div>
                    <div className="bg-emerald-50 p-6 rounded-2xl border border-emerald-100">
                      <div className="flex items-center gap-3 mb-4 text-emerald-700 font-bold">
                        {React.createElement(Search, { className: "w-5 h-5" })} 2. Scanning
                      </div>
                      <p className="text-sm text-emerald-800 leading-relaxed">Looking for specific information like dates, names, or numbers. Don't read everything; move your eyes in a Z-pattern.</p>
                    </div>
                    <div className="bg-purple-50 p-6 rounded-2xl border border-purple-100">
                      <div className="flex items-center gap-3 mb-4 text-purple-700 font-bold">
                        {React.createElement(Layers, { className: "w-5 h-5" })} 3. Intensive Reading
                      </div>
                      <p className="text-sm text-purple-800 leading-relaxed">Deep analysis of logic and grammar. Used to understand complex themes and the connection between points.</p>
                    </div>
                    <div className="bg-orange-50 p-6 rounded-2xl border border-orange-100">
                      <div className="flex items-center gap-3 mb-4 text-orange-700 font-bold">
                        {React.createElement(Glasses, { className: "w-5 h-5" })} 4. Critical Reading
                      </div>
                      <p className="text-sm text-orange-800 leading-relaxed">Evaluating the author's tone, bias, and intent. Asking: "Why did they write this and what is the underlying message?"</p>
                    </div>
                  </div>
                </div>
                <div className="p-6 border-t text-center"><button onClick={() => setShowHandbook(false)} className="bg-indigo-600 text-white px-12 py-3 rounded-full font-bold">Mastered</button></div>
              </div>
            </div>
          );

          return (
            <div className="min-h-screen bg-slate-50 font-sans text-slate-900 pb-12">
              {showHandbook && <HandbookOverlay />}
              {showCertForm && <CertificateModal />}

              <nav className="bg-white border-b border-slate-200 px-6 py-4 flex justify-between items-center sticky top-0 z-10 shadow-sm">
                <div className="flex items-center gap-2 cursor-pointer" onClick={() => setCurrentPage('landing')}>
                  {React.createElement(BookOpen, { className: "w-6 h-6 text-indigo-600" })}
                  <h1 className="text-xl font-bold tracking-tight font-serif">ReadingQuest</h1>
                </div>
                <div className="flex items-center gap-6">
                  <button onClick={() => setShowHandbook(true)} className="text-slate-500 hover:text-indigo-600 font-bold text-sm flex items-center gap-2">
                    {React.createElement(Info, { className: "w-4 h-4" })} Handbook
                  </button>
                  <div className="flex items-center gap-2 bg-indigo-50 px-3 py-1 rounded-full text-indigo-700 font-bold text-sm">
                    {React.createElement(Award, { className: "w-4 h-4" })} {userStats.points} XP
                  </div>
                </div>
              </nav>

              {currentPage === 'landing' && (
                <div className="max-w-5xl mx-auto px-6 py-12 animate-in fade-in duration-500">
                  <div className="mb-10 bg-white border border-slate-200 rounded-3xl p-8 flex flex-col md:flex-row gap-8 items-center shadow-sm relative overflow-hidden">
                     <div className="absolute top-0 right-0 p-4 opacity-5">{React.createElement(Target, { className: "w-40 h-40" })}</div>
                     <div className="bg-indigo-600 text-white p-5 rounded-2xl shrink-0 shadow-lg shadow-indigo-100">{React.createElement(Flag, { className: "w-10 h-10" })}</div>
                     <div>
                       <div className="flex items-center gap-2 mb-2">
                         <span className="bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase">LO 9.3.a Mastery</span>
                         <span className="text-slate-400 font-bold text-[10px] uppercase tracking-widest">Environmental Curriculum</span>
                       </div>
                       <h2 className="text-3xl font-bold text-slate-800 mb-2 font-serif">Earth Guardians Challenge</h2>
                       <p className="text-slate-600 text-sm italic">"Learners will identify main ideas, sentence purposes, and the connection between points in complex environmental texts."</p>
                       <div className="flex gap-4 mt-4">
                         <div className="flex items-center gap-1 text-[10px] font-bold text-slate-400 uppercase">{React.createElement(Star, { className: "w-3 h-3 text-yellow-500" })} Advanced Logic</div>
                         <div className="flex items-center gap-1 text-[10px] font-bold text-slate-400 uppercase">{React.createElement(CheckCircle2, { className: "w-3 h-3 text-green-500" })} Sectioned Summary</div>
                       </div>
                     </div>
                  </div>

                  <header className="mb-12 text-center">
                    <h2 className="text-4xl font-extrabold mb-4 text-slate-800 font-serif">Trail Map</h2>
                    <p className="text-slate-500 text-lg">Select a trail and begin your mastery quest.</p>
                  </header>

                  <div className="grid grid-cols-1 md:grid-cols-3 gap-8">
                    {modules.map(mod => (
                      <div key={mod.id} onClick={() => startModule(mod)} className="group relative bg-white border border-slate-200 rounded-3xl p-8 shadow-sm hover:shadow-2xl transition-all hover:-translate-y-2 cursor-pointer flex flex-col">
                        <div className="mb-6">{mod.icon}</div>
                        <h3 className="text-2xl font-bold mb-1 font-serif text-slate-800">{mod.title}</h3>
                        <p className="text-slate-500 text-sm mb-4 leading-relaxed">{mod.subtitle}</p>
                        <div className="mt-auto pt-6 flex items-center justify-between border-t border-slate-50">
                          <span className={`text-[10px] font-bold px-3 py-1 rounded-full ${mod.difficulty === 'Expert' ? 'bg-indigo-50 text-indigo-600' : 'bg-slate-50 text-slate-500'} uppercase tracking-widest`}>{mod.difficulty}</span>
                          {userStats.completedModules.includes(mod.id) ? React.createElement(CheckCircle2, { className: "w-6 h-6 text-green-500" }) : React.createElement(ChevronRight, { className: "w-6 h-6 text-slate-300 group-hover:text-indigo-600 transition-colors" })}
                        </div>
                        {mod.difficulty === 'Expert' && <div className="absolute top-4 right-4">{React.createElement(Sparkles, { className: "w-5 h-5 text-yellow-400 animate-pulse" })}</div>}
                      </div>
                    ))}
                  </div>
                </div>
              )}

              {currentPage === 'module' && activeModule && (
                <div className="max-w-7xl mx-auto px-6 py-8 animate-in slide-in-from-right-8 duration-500">
                  <div className="mb-8 flex items-center justify-between">
                    <button onClick={() => setCurrentPage('landing')} className="flex items-center gap-2 text-slate-400 hover:text-slate-800 font-bold uppercase text-[10px] tracking-widest transition-colors">{React.createElement(ChevronLeft, { className: "w-4 h-4" })} Exit Quest</button>
                    <div className="w-80">
                      <div className="flex justify-between text-[10px] font-bold text-slate-400 mb-1 uppercase tracking-widest">
                        <span>Trial Progress</span>
                        <span>{currentStep + 1} / {activeModule.questions.length}</span>
                      </div>
                      <ProgressBar value={currentStep + 1} max={activeModule.questions.length} />
                    </div>
                  </div>

                  <div className="grid grid-cols-1 lg:grid-cols-2 gap-10 items-start">
                    <div className="bg-white border border-slate-200 rounded-3xl shadow-sm p-10 sticky top-24 max-h-[75vh] overflow-y-auto">
                      <h3 className="text-xl font-bold mb-8 flex items-center gap-3 font-serif border-b pb-4">
                        {React.createElement(BookOpen, { className: "w-6 h-6 text-indigo-600" })}
                        Reading Pane
                      </h3>
                      <div className="space-y-10">
                        {activeModule.text.map((p, i) => (
                          <div key={p.id} className="relative pl-8 group">
                            <span className="absolute left-0 top-0 text-[10px] font-black text-slate-200 group-hover:text-indigo-200 transition-colors uppercase vertical-rl tracking-[0.5em]">PARAGRAPH {i+1}</span>
                            <p className="text-slate-700 leading-relaxed text-lg mb-2">{p.content}</p>
                          </div>
                        ))}
                      </div>
                    </div>

                    <div className="space-y-6">
                      <div className="bg-slate-900 text-white rounded-3xl p-10 shadow-xl min-h-[500px] flex flex-col relative overflow-hidden">
                        <div className="absolute -right-8 -top-8 w-40 h-40 bg-indigo-600/10 rounded-full blur-3xl"></div>
                        <div className="flex items-center justify-between mb-8 relative z-10">
                          <span className="bg-indigo-600 text-[10px] font-black px-3 py-1 rounded-full uppercase tracking-widest">
                            Challenge: {activeModule.questions[currentStep].type}
                          </span>
                          <div className="text-[10px] font-bold text-slate-400 uppercase tracking-widest flex items-center gap-2">
                            {React.createElement(Target, { className: "w-3 h-3 text-indigo-400" })}
                            Objective: {activeModule.questions[currentStep].objective}
                          </div>
                        </div>
                        
                        <h4 className="text-2xl font-bold leading-tight mb-10 relative z-10 font-serif">
                          {activeModule.questions[currentStep].q}
                        </h4>

                        <div className="space-y-4 mt-auto relative z-10">
                          {activeModule.questions[currentStep].options.map((option, idx) => (
                            <button key={idx} onClick={() => handleAnswer(idx)} disabled={feedback !== null} className="w-full text-left p-5 rounded-2xl border border-slate-800 bg-slate-800/50 hover:bg-slate-800 hover:border-indigo-500 transition-all flex items-center justify-between group">
                              <span className="text-slate-300 group-hover:text-white transition-colors">{option}</span>
                              {React.createElement(ChevronRight, { className: "w-4 h-4 opacity-0 group-hover:opacity-100 text-indigo-400 transition-all transform translate-x-0 group-hover:translate-x-1" })}
                            </button>
                          ))}
                        </div>

                        {feedback && (
                          <div className={`mt-8 p-6 rounded-2xl flex items-center gap-4 animate-in fade-in slide-in-from-bottom-4 ${feedback.type === 'success' ? 'bg-green-500/10 text-green-400 border border-green-500/20' : feedback.type === 'finish' ? 'bg-indigo-600 text-white shadow-lg shadow-indigo-500/20' : 'bg-red-500/10 text-red-400 border border-red-500/20'}`}>
                            {feedback.type === 'success' || feedback.type === 'finish' ? React.createElement(CheckCircle2, { className: "w-8 h-8 shrink-0" }) : React.createElement(AlertCircle, { className: "w-8 h-8 shrink-0" })}
                            <div className="flex-1">
                              <p className="font-bold text-lg">{feedback.msg}</p>
                              {feedback.type === 'finish' && (
                                <div className="mt-4 flex gap-4">
                                  <button onClick={() => setShowCertForm(true)} className="bg-white text-indigo-600 px-8 py-2 rounded-full font-black text-xs uppercase tracking-widest hover:bg-slate-100 transition-all shadow-md">Claim Certificate</button>
                                  <button onClick={() => setCurrentPage('landing')} className="bg-indigo-500 text-white px-8 py-2 rounded-full font-black text-xs uppercase tracking-widest border border-indigo-400 hover:bg-indigo-400 transition-all">Trail Select</button>
                                </div>
                              )}
                            </div>
                          </div>
                        )}
                      </div>

                      <div className="bg-white border border-slate-200 rounded-3xl p-8">
                        <div className="flex items-center gap-3 mb-6 text-slate-800 font-bold border-b border-slate-50 pb-4">
                          {React.createElement(ListChecks, { className: "w-5 h-5 text-indigo-600" })}
                          Objective Checklist
                        </div>
                        <div className="space-y-4">
                          <div className={`flex items-start gap-4 p-4 rounded-2xl transition-all ${currentStep >= 5 ? 'bg-green-50 border border-green-100' : 'bg-slate-50 opacity-50'}`}>
                            {React.createElement(CheckCircle2, { className: `w-5 h-5 shrink-0 ${currentStep >= 5 ? 'text-green-500' : 'text-slate-300'}` })}
                            <div>
                              <h5 className="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1">Status: {currentStep >= 5 ? 'Mastered' : 'In Progress'}</h5>
                              <p className="text-sm font-medium text-slate-700">Identify main ideas of different text sections</p>
                            </div>
                          </div>
                          <div className={`flex items-start gap-4 p-4 rounded-2xl transition-all ${currentStep >= 10 ? 'bg-green-50 border border-green-100' : 'bg-slate-50 opacity-50'}`}>
                            {React.createElement(CheckCircle2, { className: `w-5 h-5 shrink-0 ${currentStep >= 10 ? 'text-green-500' : 'text-slate-300'}` })}
                            <div>
                              <h5 className="text-[10px] font-black uppercase tracking-widest text-slate-400 mb-1">Status: {currentStep >= 10 ? 'Mastered' : 'Locked'}</h5>
                              <p className="text-sm font-medium text-slate-700">Identify sentence purposes and connection between details</p>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <footer className="mt-20 text-center border-t border-slate-100 pt-8 pb-12">
                <p className="text-[10px] font-black text-slate-300 uppercase tracking-[0.5em]">ReadingQuest &copy; 2026 Academic Excellence</p>
              </footer>
            </div>
          );
        };

        // Initialize lucide icons
        lucide.createIcons();

        // Render the app
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(App));
    </script>
</body>
</html>