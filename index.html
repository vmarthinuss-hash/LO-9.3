<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Reading Quest: Environmental Mastery</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- React & ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <!-- Babel for JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Playfair+Display:wght@700;800&display=swap" rel="stylesheet">
    
    <style>
        body { font-family: 'Inter', sans-serif; }
        .font-serif { font-family: 'Playfair Display', serif; }
        .vertical-rl { writing-mode: vertical-rl; }
        
        /* Custom scrollbar for reading pane */
        ::-webkit-scrollbar { width: 6px; }
        ::-webkit-scrollbar-track { background: #f1f1f1; }
        ::-webkit-scrollbar-thumb { background: #cbd5e1; border-radius: 10px; }
        ::-webkit-scrollbar-thumb:hover { background: #94a3b8; }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in { animation: fadeIn 0.5s ease-out forwards; }
    </style>
</head>
<body class="bg-slate-50 text-slate-900">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect } = React;

        // --- Icon Components (Inline SVG for reliability in single-file format) ---
        const Icon = ({ name, className = "w-6 h-6" }) => {
            const icons = {
                book: <path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20M4 19.5A2.5 2.5 0 0 0 6.5 22H20M4 19.5V5A2.5 2.5 0 0 1 6.5 2.5H20v14.5" />,
                award: <path d="M12 15l-3 3.5c1.1 1.1 2.5 1.5 4 1.5s2.9-.4 4-1.5L14 15M12 2a10 10 0 1 0 10 10A10 10 0 0 0 12 2zm0 18a8 8 0 1 1 8-8 8 8 0 0 1-8 8z" />,
                target: <path d="M12 22a10 10 0 1 0-10-10 10 10 0 0 0 10 10zm0-18a8 8 0 1 1-8 8 8 8 0 0 1 8-8zM12 14a2 2 0 1 0-2-2 2 2 0 0 0 2 2z" />,
                shield: <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z" />,
                leaf: <path d="M11 20A7 7 0 0 1 9.8 6.1C15.5 5 17 4.5 21 2c-2.5 4-3 5.5-4.1 11.2A7 7 0 0 1 11 20zM11 20v-5" />,
                droplets: <path d="M12 22a7 7 0 0 0 7-7c0-2-1-3.9-3-5.5s-3.5-4-4-7.5c-.5 3.5-2 5.9-4 7.5s-3 3.5-3 5.5a7 7 0 0 0 7 7z" />,
                chevronRight: <path d="M9 18l6-6-6-6" />,
                chevronLeft: <path d="M15 18l-6-6 6-6" />,
                check: <path d="M20 6L9 17l-5-5" />,
                alert: <React.Fragment><circle cx="12" cy="12" r="10" /><line x1="12" y1="8" x2="12" y2="12" /><line x1="12" y1="16" x2="12.01" y2="16" /></React.Fragment>,
                sparkles: <path d="M12 3l1.9 5.8a2 2 0 0 0 1.3 1.3L21 12l-5.8 1.9a2 2 0 0 0-1.3 1.3L12 21l-1.9-5.8a2 2 0 0 0-1.3-1.3L3 12l5.8-1.9a2 2 0 0 0 1.3-1.3L12 3z" />,
                user: <React.Fragment><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" /><circle cx="12" cy="7" r="4" /></React.Fragment>,
                grad: <React.Fragment><path d="M22 10v6M2 10l10-5 10 5-10 5z" /><path d="M6 12v5c0 2 2 3 6 3s6-1 6-3v-5" /></React.Fragment>
            };
            return (
                <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className={className}>
                    {icons[name]}
                </svg>
            );
        };

        const modules = [
            {
                id: 'conservation',
                title: 'Earth Guardians',
                subtitle: 'Why Every Action Matters',
                icon: 'shield',
                difficulty: 'Expert',
                color: 'indigo',
                lo: 'LO 9.3.a',
                text: [
                    { id: 'p1', title: 'P1: Introduction', content: "The environment includes everything around us, such as air, water, land, plants, and animals. It provides humans with food, clean water, and resources needed for daily life. However, human activities have caused serious damage to the environment. Understanding environmental problems is the first step toward protecting our planet for future generations." },
                    { id: 'p2', title: 'P2: Pollution and Its Effects', content: "One major environmental problem is pollution. Pollution happens when harmful substances enter the air, water, or soil. For example, factories release smoke into the air, and plastic waste is often thrown into rivers and oceans. As a result, pollution harms wildlife, damages ecosystems, and can cause health problems for humans." },
                    { id: 'p3', title: 'P3: Climate Change', content: "Another serious issue is climate change. Climate change refers to long-term changes in temperature and weather patterns. These changes are mainly caused by human activities such as burning fossil fuels and cutting down forests. Climate change leads to extreme weather, rising sea levels, and the loss of natural habitats." },
                    { id: 'p4', title: 'P4: The Importance of Conservation', content: "Conservation means protecting natural resources and using them wisely. By conserving water, reducing waste, and recycling materials, people can help reduce environmental damage. Governments and organizations also play an important role by creating laws that protect the environment and promote sustainable practices." },
                    { id: 'p5', title: 'P5: What Individuals Can Do', content: "Although environmental problems are global, individuals can still make a difference. Simple actions such as saving electricity, using reusable bags, and planting trees can have a positive impact. When people work together, small actions can lead to big changes and help protect the environment for the future." }
                ],
                questions: [
                    { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 1?", options: ["The environment is already destroyed", "The environment is important and needs protection", "Humans cannot survive without technology", "Animals are more important than humans"], correct: 1 },
                    { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 2?", options: ["Factories help the economy", "Plastic is useful in daily life", "Pollution causes harm to the environment and humans", "Rivers are important natural resources"], correct: 2 },
                    { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 3?", options: ["Weather changes every day", "Climate change is caused by natural disasters", "Climate change is a serious problem caused by human activity", "Forests are important for animals"], correct: 2 },
                    { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 4?", options: ["Conservation helps protect natural resources", "Governments should control people", "Recycling is difficult", "Natural resources will never run out"], correct: 0 },
                    { type: 'Main Idea', objective: 'Identify Main Ideas', q: "What is the main idea of Paragraph 5?", options: ["Environmental problems are impossible to solve", "Only governments can protect the environment", "Individuals can help protect the environment through simple actions", "Trees are the most important solution"], correct: 2 },
                    { type: 'Purpose', objective: 'Sentence Purpose', q: "What is the purpose of the first sentence in Paragraph 1?", options: ["To give an example", "To define the environment", "To explain a solution", "To describe a problem"], correct: 1 },
                    { type: 'Detail', objective: 'Connection between Points & Details', q: "Why does the writer mention factories and plastic waste in Paragraph 2?", options: ["To suggest solutions", "To compare two ideas", "To give examples of pollution", "To explain history"], correct: 2 },
                    { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word “resources” in Paragraph 1 most nearly means:", options: ["Rules", "Natural materials people use", "Pollution", "Weather conditions"], correct: 1 },
                    { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word “sustainable” in Paragraph 4 most nearly means:", options: ["Cheap and easy", "Harmful to nature", "Able to continue without damage", "Temporary"], correct: 2 },
                    { type: 'Vocab', objective: 'Vocabulary in Context', q: "The word “impact” in Paragraph 5 means:", options: ["Opinion", "Result or effect", "Rule", "Problem"], correct: 1 }
                ]
            },
            {
                id: 'marine',
                title: 'Marine Depths',
                subtitle: 'The Plastic Pollution Crisis',
                icon: 'droplets',
                difficulty: 'Intermediate',
                color: 'blue',
                lo: 'LO 9.3.a',
                text: [
                    { id: 'p1', content: "Plastic pollution has emerged as one of the most pressing environmental threats confronting marine ecosystems in the contemporary world. Each year, vast volumes of plastic waste are discharged into the oceans, where they undermine biodiversity and destabilise fragile marine habitats." },
                    { id: 'p2', content: "A particularly serious consequence of plastic pollution is its impact on marine fauna. Numerous species inadvertently ingest plastic debris, mistaking it for food, which can result in internal injury, malnutrition, or fatal blockages." },
                    { id: 'p3', content: "Although the scale of plastic pollution is alarming, a range of viable solutions has been identified. Measures such as limiting the production of single-use plastics can substantially reduce the volume of plastic entering marine ecosystems." }
                ],
                questions: [
                    { type: 'gist', objective: 'Identify Main Ideas', q: "What is the overall topic of the text?", options: ["Tourism", "Ocean Currents", "The Impact of Plastic Pollution", "Fish Migration"], correct: 2 },
                    { type: 'purpose', objective: 'Sentence Purpose', q: "Which option best describes the writer’s purpose?", options: ["To describe marine animals", "To explain causes and effects of plastic pollution", "To argue against protection", "To promote seafood"], correct: 1 }
                ]
            }
        ];

        const App = () => {
            const [currentPage, setCurrentPage] = useState('landing');
            const [activeModule, setActiveModule] = useState(null);
            const [currentStep, setCurrentStep] = useState(0);
            const [feedback, setFeedback] = useState(null);
            const [userStats, setUserStats] = useState({ points: 0, completedModules: [] });
            const [showCertForm, setShowCertForm] = useState(false);
            const [showFinalCert, setShowFinalCert] = useState(false);
            const [studentInfo, setStudentInfo] = useState({ name: '', className: '' });

            const handleAnswer = (index) => {
                const currentQuestion = activeModule.questions[currentStep];
                if (index === currentQuestion.correct) {
                    setFeedback({ type: 'success', msg: 'Correct! +100 XP' });
                    setUserStats(prev => ({ ...prev, points: prev.points + 100 }));
                    setTimeout(() => {
                        if (currentStep < activeModule.questions.length - 1) {
                            setCurrentStep(currentStep + 1);
                            setFeedback(null);
                        } else {
                            setFeedback({ type: 'finish', msg: 'Mastery Achieved!' });
                            if (!userStats.completedModules.includes(activeModule.id)) {
                                setUserStats(prev => ({ ...prev, completedModules: [...prev.completedModules, activeModule.id] }));
                            }
                        }
                    }, 1000);
                } else {
                    setFeedback({ type: 'error', msg: 'Try again! Check the text clues.' });
                    setTimeout(() => setFeedback(null), 2000);
                }
            };

            const Landing = () => (
                <div className="max-w-5xl mx-auto px-6 py-12 animate-fade-in">
                    <div className="mb-10 bg-white border border-slate-200 rounded-3xl p-8 flex flex-col md:flex-row gap-8 items-center shadow-sm">
                        <div className="bg-indigo-600 text-white p-5 rounded-2xl shadow-lg shadow-indigo-100">
                            <Icon name="award" className="w-10 h-10" />
                        </div>
                        <div>
                            <span className="bg-indigo-100 text-indigo-700 text-[10px] font-bold px-2 py-0.5 rounded uppercase mb-2 inline-block">LO 9.3.a Mastery</span>
                            <h2 className="text-3xl font-bold text-slate-800 font-serif">Environmental Mastery Trail</h2>
                            <p className="text-slate-600 text-sm mt-1">Identify main ideas, analyze sentence purposes, and earn your certificate.</p>
                        </div>
                    </div>
                    
                    <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {modules.map(mod => (
                            <div key={mod.id} onClick={() => { setActiveModule(mod); setCurrentStep(0); setCurrentPage('module'); }} className="group bg-white border border-slate-200 rounded-3xl p-8 shadow-sm hover:shadow-xl transition-all cursor-pointer">
                                <Icon name={mod.icon} className={`w-8 h-8 mb-6 text-${mod.color}-600`} />
                                <h3 className="text-2xl font-bold font-serif mb-2">{mod.title}</h3>
                                <p className="text-slate-500 text-sm mb-6">{mod.subtitle}</p>
                                <div className="flex justify-between items-center mt-auto pt-4 border-t border-slate-50">
                                    <span className="text-[10px] font-bold text-slate-400 uppercase tracking-widest">{mod.difficulty}</span>
                                    {userStats.completedModules.includes(mod.id) ? <Icon name="check" className="text-green-500" /> : <Icon name="chevronRight" className="text-slate-300 group-hover:text-indigo-600" />}
                                </div>
                            </div>
                        ))}
                    </div>
                </div>
            );

            const Certificate = () => (
                <div className="fixed inset-0 bg-slate-900/90 backdrop-blur-md z-[100] flex items-center justify-center p-4">
                    {!showFinalCert ? (
                        <div className="bg-white rounded-3xl p-8 max-w-md w-full animate-fade-in shadow-2xl">
                            <div className="text-center mb-8">
                                <Icon name="award" className="w-16 h-16 text-indigo-600 mx-auto mb-4" />
                                <h2 className="text-2xl font-bold">Claim Your Certificate</h2>
                                <p className="text-slate-500 mt-2">Expert achievements deserve recognition.</p>
                            </div>
                            <div className="space-y-4">
                                <input type="text" placeholder="Your Name" className="w-full p-4 bg-slate-50 border rounded-xl" onChange={e => setStudentInfo({...studentInfo, name: e.target.value})} />
                                <input type="text" placeholder="Class / Grade" className="w-full p-4 bg-slate-50 border rounded-xl" onChange={e => setStudentInfo({...studentInfo, className: e.target.value})} />
                            </div>
                            <button disabled={!studentInfo.name} onClick={() => setShowFinalCert(true)} className="w-full mt-8 bg-indigo-600 text-white py-4 rounded-xl font-bold shadow-lg shadow-indigo-100">Issue My Award</button>
                        </div>
                    ) : (
                        <div className="bg-white rounded-3xl p-1 shadow-2xl max-w-4xl w-full animate-fade-in">
                            <div className="bg-white p-16 border-8 border-double border-indigo-100 rounded-[2rem] text-center">
                                <Icon name="book" className="w-12 h-12 text-indigo-600 mx-auto mb-6" />
                                <h1 className="text-5xl font-serif text-slate-800 mb-2">Certificate of Mastery</h1>
                                <p className="text-slate-400 font-bold uppercase tracking-widest text-xs mb-12">Academic Literacy Achievement</p>
                                <p className="text-slate-500 italic mb-4">This is awarded to</p>
                                <h2 className="text-4xl font-bold text-indigo-700 border-b-2 inline-block px-12 py-2 mb-8 font-serif">{studentInfo.name}</h2>
                                <p className="text-slate-600 max-w-md mx-auto">Successful completion of the <strong>{activeModule.title}</strong> trail, demonstrating mastery of curriculum standard <strong>{activeModule.lo}</strong>.</p>
                                <div className="mt-16 flex justify-between px-12 items-end">
                                    <div className="text-center">
                                        <div className="w-40 border-b pb-1 text-slate-800 font-serif italic">ReadingQuest</div>
                                        <div className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">Academy Board</div>
                                    </div>
                                    <div className="p-4 bg-indigo-600 text-white rounded-full shadow-lg"><Icon name="shield" className="w-10 h-10" /></div>
                                    <div className="text-center">
                                        <div className="w-40 border-b pb-1 text-slate-800 font-mono">{new Date().toLocaleDateString()}</div>
                                        <div className="text-[10px] font-bold text-slate-400 uppercase tracking-widest mt-1">Date Issued</div>
                                    </div>
                                </div>
                            </div>
                            <div className="bg-slate-900 p-4 flex justify-center">
                                <button onClick={() => { setShowFinalCert(false); setShowCertForm(false); setCurrentPage('landing'); }} className="text-white font-bold hover:text-indigo-400">Return to trails</button>
                            </div>
                        </div>
                    )}
                </div>
            );

            return (
                <div className="min-h-screen pb-20">
                    {showCertForm && <Certificate />}
                    <nav className="bg-white border-b px-8 py-4 flex justify-between items-center sticky top-0 z-50">
                        <div className="flex items-center gap-2 cursor-pointer" onClick={() => setCurrentPage('landing')}>
                            <Icon name="book" className="text-indigo-600" />
                            <h1 className="text-xl font-bold font-serif tracking-tight">ReadingQuest</h1>
                        </div>
                        <div className="flex items-center gap-4">
                            <div className="flex items-center gap-2 bg-indigo-50 px-4 py-1.5 rounded-full text-indigo-700 font-bold text-xs">
                                <Icon name="award" className="w-4 h-4" /> {userStats.points} XP
                            </div>
                        </div>
                    </nav>

                    {currentPage === 'landing' ? <Landing /> : (
                        <div className="max-w-7xl mx-auto px-6 py-12 animate-fade-in grid grid-cols-1 lg:grid-cols-2 gap-12">
                            <div className="bg-white border rounded-3xl p-10 shadow-sm max-h-[80vh] overflow-y-auto">
                                <h3 className="text-2xl font-bold font-serif mb-8 border-b pb-4 flex items-center gap-3">
                                    <Icon name="book" className="text-indigo-600" /> Reading Text
                                </h3>
                                <div className="space-y-12">
                                    {activeModule.text.map((p, i) => (
                                        <div key={p.id} className="relative pl-8 group">
                                            <span className="absolute left-0 top-0 text-[10px] font-black text-slate-200 group-hover:text-indigo-200 uppercase vertical-rl tracking-[0.4em]">P{i+1}</span>
                                            <p className="text-lg text-slate-700 leading-relaxed">{p.content}</p>
                                        </div>
                                    ))}
                                </div>
                            </div>

                            <div className="space-y-6">
                                <div className="bg-slate-900 text-white rounded-3xl p-10 shadow-xl min-h-[450px] flex flex-col relative">
                                    <div className="mb-8 flex justify-between items-start">
                                        <span className="bg-indigo-600 text-[10px] font-bold px-3 py-1 rounded-full uppercase tracking-widest">{activeModule.questions[currentStep].type}</span>
                                        <div className="w-32"><div className="h-1.5 w-full bg-slate-800 rounded-full overflow-hidden"><div className="h-full bg-indigo-500 transition-all" style={{width: `${((currentStep+1)/activeModule.questions.length)*100}%`}}></div></div></div>
                                    </div>
                                    <h4 className="text-2xl font-bold font-serif leading-tight mb-8">{activeModule.questions[currentStep].q}</h4>
                                    <div className="space-y-4 mt-auto">
                                        {activeModule.questions[currentStep].options.map((opt, i) => (
                                            <button key={i} onClick={() => handleAnswer(i)} disabled={feedback !== null} className="w-full text-left p-5 rounded-2xl bg-slate-800 border border-slate-700 hover:border-indigo-500 hover:bg-slate-750 transition-all flex items-center justify-between group">
                                                <span className="text-slate-300 group-hover:text-white">{opt}</span>
                                                <Icon name="chevronRight" className="w-4 h-4 opacity-0 group-hover:opacity-100 text-indigo-400" />
                                            </button>
                                        ))}
                                    </div>
                                    {feedback && (
                                        <div className={`mt-8 p-6 rounded-2xl flex items-center gap-4 animate-fade-in ${feedback.type === 'success' ? 'bg-green-500/10 text-green-400' : feedback.type === 'finish' ? 'bg-indigo-600 text-white' : 'bg-red-500/10 text-red-400'}`}>
                                            <Icon name={feedback.type === 'error' ? 'alert' : 'check'} />
                                            <div className="flex-1">
                                                <p className="font-bold">{feedback.msg}</p>
                                                {feedback.type === 'finish' && <button onClick={() => setShowCertForm(true)} className="mt-4 bg-white text-indigo-600 px-8 py-2 rounded-full font-bold text-xs uppercase shadow-lg">Issue My Certificate</button>}
                                            </div>
                                        </div>
                                    )}
                                </div>
                                <div className="bg-white border rounded-3xl p-8 shadow-sm">
                                    <h5 className="font-bold flex items-center gap-2 mb-4 text-slate-800"><Icon name="target" className="w-4 h-4 text-indigo-600" /> Objective Checklist</h5>
                                    <div className="space-y-3">
                                        <div className={`flex items-center gap-3 p-3 rounded-xl text-xs font-semibold ${currentStep > 4 ? 'bg-green-50 text-green-700' : 'bg-slate-50 text-slate-400'}`}>
                                            <Icon name="check" className="w-3 h-3" /> Identifying Main Ideas
                                        </div>
                                        <div className={`flex items-center gap-3 p-3 rounded-xl text-xs font-semibold ${currentStep > 8 ? 'bg-green-50 text-green-700' : 'bg-slate-50 text-slate-400'}`}>
                                            <Icon name="check" className="w-3 h-3" /> Vocabulary Analysis
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    )}
                </div>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
